# Анализ динамической системы: преобразование и оценка параметров

## Задача
1. Преобразовать дифференциальное уравнение второго порядка в систему уравнений первого порядка (форма Коши).
2. Оценить параметры системы при единичном входном воздействии и нулевых начальных условиях.

---

## Исходное уравнение
Уравнение системы:  
\[
\ddot{y}(t) + 2\dot{y}(t) + 2y(t) = 3 \quad (\text{при } u(t) = 1).
\]

---

## Решение

### 1. Преобразование в форму Коши
Введем переменные состояния:  
- \( x_1 = y \) (положение),  
- \( x_2 = \dot{y} \) (скорость).  

Система уравнений первого порядка:  
\[
\begin{cases} 
\dot{x}_1 = x_2, \\
\dot{x}_2 = -2x_2 - 2x_1 + 3.
\end{cases}
\]

---

### 2. Оценка параметров
**Цель:** Найти коэффициенты \( a = 2 \), \( b = 2 \) из уравнения \( \ddot{y} + a\dot{y} + b y = 3 \).  

**Алгоритм:**
1. Сгенерировать "идеальные" данные, решив уравнение с \( a = 2 \), \( b = 2 \).
2. Использовать метод наименьших квадратов (`scipy.optimize.leastsq`), чтобы подобрать параметры, минимизирующие ошибку между моделью и данными.

## Исходный код
```python
import numpy as np
from scipy import integrate, optimize
import pylab as pp

# Определение системы ДУ
def ode(y, t, k):
    x1, x2 = y
    a, b = k
    return [x2, -a * x2 - b * x1 + 3]

# Генерация данных
true_a, true_b = 2, 2
sol, t = integrate.odeint(ode, [0, 0], np.linspace(0, 10, 101), args=([true_a, true_b],))

# Оценка параметров
class ParameterEstimator:
    # ... (полный код из примера выше)

estimator = ParameterEstimator(t, sol[:, 0].reshape(-1, 1), ode)
est_par, est_y0 = estimator.estimate(y0=[0, 0], guess=[1.5, 1.5])
estimator.plot_result()
